library(testthat)
library(antigen.garnish)
library(data.table)
library(magrittr)

test_that("ftrans", {

  # load test data
  v <- "ATGTCTTCTTTTGCTTGCTGGAGCCTGTCTCTTCTTATCCTGTTCTACAGCCCAGGGTCTGGTGAGAAGGCCTTTGAGGTCTACATATGGTCCGAGAAGCAGATAGTAGAAGCCACAGAGTCTTGGAAAATCAACTGCAGCACCAACTGCGCAGCCCCAGACATGGGCGGCCTGGAGACGCCCACGAATAAAATAATGTTGGAAGAGCATCCTCAAGGGAAGTGGAAACAGTTCTTAGTCTCAAACGTCTCCAAAGACACGGTCTTCTTTTGCCATTTCACGTGTTCGGGAAAGCAGCACTCGGAGAGTCTCAACATCAGGGTGTACCAGCCTCCAGCTCAAGTCACACTGAAGCTGCAGCCGCCTCGGGTGTTTGTGGGTGAAGACTTCACCATTGAGTGCACGGTGTCCCCTGTGCAGCCCCTTGAGAGGCTCACCCTCTCTCTGCTCCGTGGCAGAGAGACCCTGAAGAATCAGACCTTTGGGGGAGCAGAAACTGTCCCCCAAGAGGCCACAGCCACGTTCAACAGCACAGCTCTGAAAAAGGACGGTCTCAACTTTTCCTGCCAGGCTGAGCTGGATCTACGGCCCCATGGTGGGTATATCATCCGCAGCATCTCGGAGTACCAGATCCTTGAAGTCTATGAGCCGATGCAGGACAACCAAATGGTCATCATCATCGTGGTGGTGTCAATACTGCTGTTCTTATTTGTGACATCTGTCCTGCTATGCTTTATCTTTGGCCAGCACTGGCACAGAAGACGGACAGGCACCTACGGGGTGCTAGCTGCCTGGAGGAGGCTGCCCCGAGCCTTTCGGGCACGTCCCGTGTGA"

  # test
  antigen.garnish:::ftrans(v) %>%
   testthat::expect_equal(., "MSSFACWSLSLLILFYSPGSGEKAFEVYIWSEKQIVEATESWKINCSTNCAAPDMGGLETPTNKIMLEEHPQGKWKQFLVSNVSKDTVFFCHFTCSGKQHSESLNIRVYQPPAQVTLKLQPPRVFVGEDFTIECTVSPVQPLERLTLSLLRGRETLKNQTFGGAETVPQEATATFNSTALKKDGLNFSCQAELDLRPHGGYIIRSISEYQILEVYEPMQDNQMVIIIVVVSILLFLFVTSVLLCFIFGQHWHRRRTGTYGVLAAWRRLPRAFRARPV*")
    })
